{
  "uid" : "5dae513f4e34bb0b",
  "name" : "test_all_api[data0]",
  "fullName" : "api.cases.test_api4.TestAPI#test_all_api",
  "historyId" : "e1e13cbadfd720f042c49bcc73b37cdc",
  "time" : {
    "start" : 1609411600484,
    "stop" : 1609411600484,
    "duration" : 0
  },
  "description" : "FILE SHEET： t_接  \n\nFILE NAME： test_a1pidat2a - 副本.xlsx  \n\nFILE PATH： D:/desk20201127/ks/Datas/test_a1pidat2a - 副本.xlsx",
  "descriptionHtml" : "<p>FILE SHEET： t_接</p>\n<p>FILE NAME： test_a1pidat2a - 副本.xlsx</p>\n<p>FILE PATH： D:/desk20201127/ks/Datas/test_a1pidat2a - 副本.xlsx</p>\n",
  "status" : "broken",
  "statusMessage" : "FileNotFoundError: [Errno 2] No such file or directory: 'D:\\\\desk20201127\\\\ks\\\\Report\\\\2020-12-31_allure\\\\test_a1pidat2a - 副本_report(4).xlsx'",
  "statusTrace" : "self = <api.cases.test_api4.TestAPI object at 0x000001FB5BF54BC8>\nrequests_session = <requests.sessions.Session object at 0x000001FB5C071808>\ndata = {'file1': 'test_a1pidat2a - 副本.xlsx', 'filepath1': 'D:/desk20201127/ks/Datas/test_a1pidat2a - 副本.xlsx', 'filesheet1': ... 'addheader', ...}, {'exec': '6', 'expect': '', 'input': 'register', 'method': 'post', ...}, ...], 'sheetname1': 't_接'}\n\n    @pytest.mark.parametrize('data', apidata)\n    def test_all_api(self, requests_session, data):\n    \n        http = Http(requests_session)\n    \n        allure.dynamic.feature(f'API测试')\n        allure.dynamic.story(f'{list(data.values())[1]}<>{list(data.values())[0]}')\n        allure.dynamic.description(f'FILE SHEET： {list(data.values())[0]}  \\n\\nFILE NAME： {list(data.values())[1]}  \\n\\nFILE PATH： {list(data.values())[2]}')\n        logger.info(f'API测试')\n        logger.info(f'FILE SHEET： {list(data.values())[0]}  FILE NAME： {list(data.values())[1]}  FILE PATH： {list(data.values())[2]}')\n    \n>       wb, sheet, write_path = self.load_excel_setup(list(data.values())[0], list(data.values())[1], list(data.values())[2])\n\napi\\cases\\test_api4.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\napi\\cases\\test_api4.py:101: in load_excel_setup\n    wb, sheet = load_excel(write_file_path, sheet_name)\nCommon\\excel_api.py:176: in load_excel\n    wb = load_workbook(file_name)\nvenv\\lib\\site-packages\\openpyxl\\reader\\excel.py:314: in load_workbook\n    data_only, keep_links)\nvenv\\lib\\site-packages\\openpyxl\\reader\\excel.py:124: in __init__\n    self.archive = _validate_archive(fn)\nvenv\\lib\\site-packages\\openpyxl\\reader\\excel.py:96: in _validate_archive\n    archive = ZipFile(filename, 'r')\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <zipfile.ZipFile [closed]>\nfile = 'D:\\\\desk20201127\\\\ks\\\\Report\\\\2020-12-31_allure\\\\test_a1pidat2a - 副本_report(4).xlsx'\nmode = 'r', compression = 0, allowZip64 = True, compresslevel = None\n\n    def __init__(self, file, mode=\"r\", compression=ZIP_STORED, allowZip64=True,\n                 compresslevel=None):\n        \"\"\"Open the ZIP file with mode read 'r', write 'w', exclusive create 'x',\n        or append 'a'.\"\"\"\n        if mode not in ('r', 'w', 'x', 'a'):\n            raise ValueError(\"ZipFile requires mode 'r', 'w', 'x', or 'a'\")\n    \n        _check_compression(compression)\n    \n        self._allowZip64 = allowZip64\n        self._didModify = False\n        self.debug = 0  # Level of printing: 0 through 3\n        self.NameToInfo = {}    # Find file info given name\n        self.filelist = []      # List of ZipInfo instances for archive\n        self.compression = compression  # Method of compression\n        self.compresslevel = compresslevel\n        self.mode = mode\n        self.pwd = None\n        self._comment = b''\n    \n        # Check if we were passed a file-like object\n        if isinstance(file, os.PathLike):\n            file = os.fspath(file)\n        if isinstance(file, str):\n            # No, it's a filename\n            self._filePassed = 0\n            self.filename = file\n            modeDict = {'r' : 'rb', 'w': 'w+b', 'x': 'x+b', 'a' : 'r+b',\n                        'r+b': 'w+b', 'w+b': 'wb', 'x+b': 'xb'}\n            filemode = modeDict[mode]\n            while True:\n                try:\n>                   self.fp = io.open(file, filemode)\nE                   FileNotFoundError: [Errno 2] No such file or directory: 'D:\\\\desk20201127\\\\ks\\\\Report\\\\2020-12-31_allure\\\\test_a1pidat2a - 副本_report(4).xlsx'\n\nC:\\Python37\\lib\\zipfile.py:1207: FileNotFoundError",
  "flaky" : false,
  "newFailed" : false,
  "beforeStages" : [ {
    "name" : "_session_faker",
    "time" : {
      "start" : 1609411600394,
      "stop" : 1609411600474,
      "duration" : 80
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "hasContent" : false,
    "shouldDisplayMessage" : false,
    "attachmentsCount" : 0
  }, {
    "name" : "requests_session",
    "time" : {
      "start" : 1609411600474,
      "stop" : 1609411600484,
      "duration" : 10
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "hasContent" : false,
    "shouldDisplayMessage" : false,
    "attachmentsCount" : 0
  } ],
  "testStage" : {
    "description" : "FILE SHEET： t_接  \n\nFILE NAME： test_a1pidat2a - 副本.xlsx  \n\nFILE PATH： D:/desk20201127/ks/Datas/test_a1pidat2a - 副本.xlsx",
    "status" : "broken",
    "statusMessage" : "FileNotFoundError: [Errno 2] No such file or directory: 'D:\\\\desk20201127\\\\ks\\\\Report\\\\2020-12-31_allure\\\\test_a1pidat2a - 副本_report(4).xlsx'",
    "statusTrace" : "self = <api.cases.test_api4.TestAPI object at 0x000001FB5BF54BC8>\nrequests_session = <requests.sessions.Session object at 0x000001FB5C071808>\ndata = {'file1': 'test_a1pidat2a - 副本.xlsx', 'filepath1': 'D:/desk20201127/ks/Datas/test_a1pidat2a - 副本.xlsx', 'filesheet1': ... 'addheader', ...}, {'exec': '6', 'expect': '', 'input': 'register', 'method': 'post', ...}, ...], 'sheetname1': 't_接'}\n\n    @pytest.mark.parametrize('data', apidata)\n    def test_all_api(self, requests_session, data):\n    \n        http = Http(requests_session)\n    \n        allure.dynamic.feature(f'API测试')\n        allure.dynamic.story(f'{list(data.values())[1]}<>{list(data.values())[0]}')\n        allure.dynamic.description(f'FILE SHEET： {list(data.values())[0]}  \\n\\nFILE NAME： {list(data.values())[1]}  \\n\\nFILE PATH： {list(data.values())[2]}')\n        logger.info(f'API测试')\n        logger.info(f'FILE SHEET： {list(data.values())[0]}  FILE NAME： {list(data.values())[1]}  FILE PATH： {list(data.values())[2]}')\n    \n>       wb, sheet, write_path = self.load_excel_setup(list(data.values())[0], list(data.values())[1], list(data.values())[2])\n\napi\\cases\\test_api4.py:40: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\napi\\cases\\test_api4.py:101: in load_excel_setup\n    wb, sheet = load_excel(write_file_path, sheet_name)\nCommon\\excel_api.py:176: in load_excel\n    wb = load_workbook(file_name)\nvenv\\lib\\site-packages\\openpyxl\\reader\\excel.py:314: in load_workbook\n    data_only, keep_links)\nvenv\\lib\\site-packages\\openpyxl\\reader\\excel.py:124: in __init__\n    self.archive = _validate_archive(fn)\nvenv\\lib\\site-packages\\openpyxl\\reader\\excel.py:96: in _validate_archive\n    archive = ZipFile(filename, 'r')\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <zipfile.ZipFile [closed]>\nfile = 'D:\\\\desk20201127\\\\ks\\\\Report\\\\2020-12-31_allure\\\\test_a1pidat2a - 副本_report(4).xlsx'\nmode = 'r', compression = 0, allowZip64 = True, compresslevel = None\n\n    def __init__(self, file, mode=\"r\", compression=ZIP_STORED, allowZip64=True,\n                 compresslevel=None):\n        \"\"\"Open the ZIP file with mode read 'r', write 'w', exclusive create 'x',\n        or append 'a'.\"\"\"\n        if mode not in ('r', 'w', 'x', 'a'):\n            raise ValueError(\"ZipFile requires mode 'r', 'w', 'x', or 'a'\")\n    \n        _check_compression(compression)\n    \n        self._allowZip64 = allowZip64\n        self._didModify = False\n        self.debug = 0  # Level of printing: 0 through 3\n        self.NameToInfo = {}    # Find file info given name\n        self.filelist = []      # List of ZipInfo instances for archive\n        self.compression = compression  # Method of compression\n        self.compresslevel = compresslevel\n        self.mode = mode\n        self.pwd = None\n        self._comment = b''\n    \n        # Check if we were passed a file-like object\n        if isinstance(file, os.PathLike):\n            file = os.fspath(file)\n        if isinstance(file, str):\n            # No, it's a filename\n            self._filePassed = 0\n            self.filename = file\n            modeDict = {'r' : 'rb', 'w': 'w+b', 'x': 'x+b', 'a' : 'r+b',\n                        'r+b': 'w+b', 'w+b': 'wb', 'x+b': 'xb'}\n            filemode = modeDict[mode]\n            while True:\n                try:\n>                   self.fp = io.open(file, filemode)\nE                   FileNotFoundError: [Errno 2] No such file or directory: 'D:\\\\desk20201127\\\\ks\\\\Report\\\\2020-12-31_allure\\\\test_a1pidat2a - 副本_report(4).xlsx'\n\nC:\\Python37\\lib\\zipfile.py:1207: FileNotFoundError",
    "steps" : [ ],
    "attachments" : [ {
      "uid" : "9d088ba55c3da228",
      "name" : "log",
      "source" : "9d088ba55c3da228.txt",
      "type" : "text/plain",
      "size" : 977
    } ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "hasContent" : true,
    "shouldDisplayMessage" : true,
    "attachmentsCount" : 1
  },
  "afterStages" : [ {
    "name" : "requests_session::0",
    "time" : {
      "start" : 1609411600654,
      "stop" : 1609411600654,
      "duration" : 0
    },
    "status" : "passed",
    "steps" : [ ],
    "attachments" : [ ],
    "parameters" : [ ],
    "stepsCount" : 0,
    "hasContent" : false,
    "shouldDisplayMessage" : false,
    "attachmentsCount" : 0
  } ],
  "labels" : [ {
    "name" : "feature",
    "value" : "API测试"
  }, {
    "name" : "story",
    "value" : "test_a1pidat2a - 副本.xlsx<>t_接"
  }, {
    "name" : "parentSuite",
    "value" : "api.cases"
  }, {
    "name" : "suite",
    "value" : "test_api4"
  }, {
    "name" : "subSuite",
    "value" : "TestAPI"
  }, {
    "name" : "host",
    "value" : "DESKTOP-V8HO8M4"
  }, {
    "name" : "thread",
    "value" : "11180-MainThread"
  }, {
    "name" : "framework",
    "value" : "pytest"
  }, {
    "name" : "language",
    "value" : "cpython3"
  }, {
    "name" : "package",
    "value" : "api.cases.test_api4"
  }, {
    "name" : "resultFormat",
    "value" : "allure2"
  } ],
  "parameters" : [ {
    "name" : "data",
    "value" : "{'sheetname1': 't_接', 'file1': 'test_a1pidat2a - 副本.xlsx', 'filepath1': 'D:/desk20201127/ks/Datas/test_a1pidat2a - 副本.xlsx', 'filesheet1': [{'num': '1', 'exec': '1', 'title': '充1', 'method': 'seturl', 'input': 'http://testingedu.com.cn:8081/inter/HTTP', 'request_data': '{user}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '2', 'exec': '2', 'title': '', 'method': 'addheader', 'input': 'token', 'request_data': '', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '3', 'exec': '3', 'title': '', 'method': 'post', 'input': 'auth', 'request_data': '', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '4', 'exec': '4', 'title': '充2', 'method': 'savejson', 'input': 'token', 'request_data': 'token', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '5', 'exec': '5', 'title': '', 'method': 'addheader', 'input': 'token', 'request_data': '{token}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '6', 'exec': '6', 'title': '', 'method': 'post', 'input': 'register', 'request_data': '{\"username\": \"\", \"pwd\": \"123456\", \"nickname\":\"熊明\"}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '7', 'exec': '7', 'title': '', 'method': 'assertequals', 'input': 'status', 'request_data': '200', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '9', 'exec': '8', 'title': '', 'method': 'post', 'input': 'register', 'request_data': '{\"username\": \"\", \"pwd\": \"126\", \"nickname\":\"熊明\"}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '10', 'exec': '9', 'title': '', 'method': 'assertequals', 'input': 'status', 'request_data': '402', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}]}"
  } ],
  "links" : [ ],
  "hidden" : false,
  "retry" : false,
  "extra" : {
    "severity" : "normal",
    "retries" : [ ],
    "categories" : [ {
      "name" : "Test defects",
      "matchedStatuses" : [ ],
      "flaky" : false
    } ],
    "tags" : [ ]
  },
  "source" : "5dae513f4e34bb0b.json",
  "parameterValues" : [ "{'sheetname1': 't_接', 'file1': 'test_a1pidat2a - 副本.xlsx', 'filepath1': 'D:/desk20201127/ks/Datas/test_a1pidat2a - 副本.xlsx', 'filesheet1': [{'num': '1', 'exec': '1', 'title': '充1', 'method': 'seturl', 'input': 'http://testingedu.com.cn:8081/inter/HTTP', 'request_data': '{user}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '2', 'exec': '2', 'title': '', 'method': 'addheader', 'input': 'token', 'request_data': '', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '3', 'exec': '3', 'title': '', 'method': 'post', 'input': 'auth', 'request_data': '', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '4', 'exec': '4', 'title': '充2', 'method': 'savejson', 'input': 'token', 'request_data': 'token', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '5', 'exec': '5', 'title': '', 'method': 'addheader', 'input': 'token', 'request_data': '{token}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '6', 'exec': '6', 'title': '', 'method': 'post', 'input': 'register', 'request_data': '{\"username\": \"\", \"pwd\": \"123456\", \"nickname\":\"熊明\"}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '7', 'exec': '7', 'title': '', 'method': 'assertequals', 'input': 'status', 'request_data': '200', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '9', 'exec': '8', 'title': '', 'method': 'post', 'input': 'register', 'request_data': '{\"username\": \"\", \"pwd\": \"126\", \"nickname\":\"熊明\"}', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}, {'num': '10', 'exec': '9', 'title': '', 'method': 'assertequals', 'input': 'status', 'request_data': '402', 'status': '', 'expect': '', 'return_code': '', 'return_values': ''}]}" ]
}